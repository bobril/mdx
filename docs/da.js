(function(e){"use strict";var t=__bbb.ed;var a=__bbb.Mb;var _=__bbb.Ac;var i=__bbb.Nb;var n=__bbb.tc;var r=__bbb.uc;var o=__bbb.hc;var l=__bbb.ic;var s=__bbb.kc;var c=__bbb.jc;var d=__bbb.id;var u=__bbb.jd;var h=__bbb.Jd;var b=__bbb.ac;var g=__bbb.dd;var p=__bbb.Id;var v=__bbb.Kd;var D=__bbb.Ld;var m=__bbb.Md;var A=__bbb.sc;var S=t.pie;var E={sections:new Map,showData:!1,config:S};var k=E.sections;var f=E.showData;var B=structuredClone(S);var C=a(()=>structuredClone(B),"getConfig");var G=a(()=>{k=new Map;f=E.showData;_()},"clear");var x=a(({label:e,value:t})=>{if(t<0){throw new Error(`"${e}" has invalid value: ${t}. Negative values are not allowed in pie charts. All slice values must be >= 0.`)}if(!k.has(e)){k.set(e,t);i.debug(`added new section: ${e}, with value: ${t}`)}},"addSection");var T=a(()=>k,"getSections");var J=a(e=>{f=e},"setShowData");var R=a(()=>f,"getShowData");var w={getConfig:C,clear:G,setDiagramTitle:n,getDiagramTitle:r,setAccTitle:o,getAccTitle:l,setAccDescription:s,getAccDescription:c,addSection:x,getSections:T,setShowData:J,getShowData:R};var F=a((e,t)=>{d(e,t);t.setShowData(e.showData);e.sections.map(t.addSection)},"populateDb");var I={parse:a(async e=>{const t=await u("pie",e);i.debug(t);F(t,w)},"parse")};var Z=a(e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`,"getStyles");var N=a(e=>{const t=[...e.values()].reduce((e,t)=>e+t,0);const a=[...e.entries()].map(([e,t])=>({label:e,value:t})).filter(e=>e.value/t*100>=1).sort((e,t)=>t.value-e.value);const _=h().value(e=>e.value);return _(a)},"createPieArcs");var $=a((e,t,a,_)=>{i.debug("rendering pie chart\n"+e);const n=_.db;const r=b();const o=g(n.getConfig(),r.pie);const l=40;const s=18;const c=4;const d=450;const u=p(t);const h=u.append("g");h.attr("transform","translate("+d/2+","+d/2+")");const{themeVariables:S}=r;let[E]=v(S.pieOuterStrokeWidth);E!==null&&E!==void 0?E:E=2;const k=o.textPosition;const f=Math.min(d,d)/2-l;const B=D().innerRadius(0).outerRadius(f);const C=D().innerRadius(f*k).outerRadius(f*k);h.append("circle").attr("cx",0).attr("cy",0).attr("r",f+E/2).attr("class","pieOuterCircle");const G=n.getSections();const x=N(G);const T=[S.pie1,S.pie2,S.pie3,S.pie4,S.pie5,S.pie6,S.pie7,S.pie8,S.pie9,S.pie10,S.pie11,S.pie12];let J=0;G.forEach(e=>{J+=e});const R=x.filter(e=>(e.data.value/J*100).toFixed(0)!=="0");const w=m(T);h.selectAll("mySlices").data(R).enter().append("path").attr("d",B).attr("fill",e=>w(e.data.label)).attr("class","pieCircle");h.selectAll("mySlices").data(R).enter().append("text").text(e=>(e.data.value/J*100).toFixed(0)+"%").attr("transform",e=>"translate("+C.centroid(e)+")").style("text-anchor","middle").attr("class","slice");h.append("text").text(n.getDiagramTitle()).attr("x",0).attr("y",-(d-50)/2).attr("class","pieTitleText");const F=[...G.entries()].map(([e,t])=>({label:e,value:t}));const I=h.selectAll(".legend").data(F).enter().append("g").attr("class","legend").attr("transform",(e,t)=>{const a=s+c;const _=a*F.length/2;const i=12*s;const n=t*a-_;return"translate("+i+","+n+")"});I.append("rect").attr("width",s).attr("height",s).style("fill",e=>w(e.label)).style("stroke",e=>w(e.label));I.append("text").attr("x",s+c).attr("y",s-c).text(e=>{if(n.getShowData()){return`${e.label} [${e.value}]`}return e.label});const Z=Math.max(...I.selectAll("text").nodes().map(e=>{var t;return(t=e===null||e===void 0?void 0:e.getBoundingClientRect().width)!==null&&t!==void 0?t:0}));const $=d+l+s+c+Z;u.attr("viewBox",`0 0 ${$} ${d}`);A(u,d,$,o.useMaxWidth)},"draw");var Y={draw:$};var L={parser:I,db:w,renderer:Y,styles:Z};var y={diagram:L};__bbb.C=y}).call(this)