(function(e){"use strict";var t=function(e){if(!("default"in e))return e;var t=e.default;if(typeof t==="object"||typeof t==="function"){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&o!=="default"&&(t[o]=e[o])}return t};var o=function(e,t,o){typeof t==="symbol"&&(t=t.description?"[".concat(t.description,"]"):"");return Object.defineProperty(e,"name",{configurable:!0,value:o?"".concat(o," ",t):t})};var n=__bbb.bc;var i=__bbb.Mb;var r=__bbb.hc;var s=__bbb.ic;var a=__bbb.tc;var d=__bbb.uc;var c=__bbb.jc;var l=__bbb.kc;var u=__bbb.Ac;var p=__bbb.dd;var h=__bbb.ed;var _=__bbb.fd;var g=__bbb.id;var f=__bbb.jd;var m=__bbb.Nb;var v=__bbb.ze;var y=__bbb.we;var x=__bbb.ac;var b=__bbb.Ae;var C=__bbb.gc;var E=__bbb.Be;var I=__bbb.cc;var A=__bbb.dc;var N=__bbb.Id;var D=__bbb.le;var w=function(){var o={};var i={exports:o};(function e(t,r){if(typeof o==="object"&&typeof i==="object")i.exports=r(n);else if(typeof define==="function"&&define.amd)define(["cose-base"],r);else if(typeof o==="object")o["cytoscapeFcose"]=r(n);else t["cytoscapeFcose"]=r(t["coseBase"])})(this,function(t){return(()=>{var o={658:e=>{e.exports=Object.assign!=null?Object.assign.bind(Object):function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),n=1;n<t;n++){o[n-1]=arguments[n]}o.forEach(function(t){Object.keys(t).forEach(function(o){return e[o]=t[o]})});return e}},548:(t,o,n)=>{var i=function(){function t(t,o){var n=[];var i=!0;var r=!1;var s=e;try{for(var a=t[Symbol.iterator](),d;!(i=(d=a.next()).done);i=!0){n.push(d.value);if(o&&n.length===o)break}}catch(e){r=!0;s=e}finally{try{if(!i&&a["return"])a["return"]()}finally{if(r)throw s}}return n}return function(e,o){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return t(e,o)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var r=n(140).layoutBase.LinkedList;var s={};s.getTopMostNodes=function(e){var t={};for(var o=0;o<e.length;o++){t[e[o].id()]=!0}var n=e.filter(function(e,o){typeof e==="number"&&(e=o);var n=e.parent()[0];while(n!=null){if(t[n.id()]){return!1}n=n.parent()[0]}return!0});return n};s.connectComponents=function(e,t,o,n){var i=new r;var s=new Set;var a=[];var d=void 0;var c=void 0;var l=void 0;var u=!1;var p=1;var h=[];var _=[];var g=function n(){var r=e.collection();_.push(r);var g=o[0];var f=e.collection();f.merge(g).merge(g.descendants().intersection(t));a.push(g);f.forEach(function(e){i.push(e);s.add(e);r.merge(e)});var m=function n(){g=i.shift();var c=e.collection();g.neighborhood().nodes().forEach(function(e){t.intersection(g.edgesWith(e)).length>0&&c.merge(e)});for(var l=0;l<c.length;l++){var u=c[l];d=o.intersection(u.union(u.ancestors()));if(d!=null&&!s.has(d[0])){var p=d.union(d.descendants());p.forEach(function(e){i.push(e);s.add(e);r.merge(e);o.has(e)&&a.push(e)})}}};while(i.length!=0){m()}r.forEach(function(e){t.intersection(e.connectedEdges()).forEach(function(e){r.has(e.source())&&r.has(e.target())&&r.merge(e)})});a.length==o.length&&(u=!0);if(!u||u&&p>1){c=a[0];l=c.connectedEdges().length;a.forEach(function(e){if(e.connectedEdges().length<l){l=e.connectedEdges().length;c=e}});h.push(c.id());var v=e.collection();v.merge(a[0]);a.forEach(function(e){v.merge(e)});a=[];o=o.difference(v);p++}};do{g()}while(!u);n&&(h.length>0&&n.set("dummy"+(n.size+1),h));return _};s.relocateComponent=function(t,o,n){if(!n.fixedNodeConstraint){var r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY;if(n.quality=="draft"){var c=!0,l=!1,u=e;try{for(var p=o.nodeIndexes[Symbol.iterator](),h;!(c=(h=p.next()).done);c=!0){var _=h.value,g=i(_,2),f=g[0],m=g[1],v=n.cy.getElementById(f);if(v){var y=v.boundingBox(),x=o.xCoords[m]-y.w/2,b=o.xCoords[m]+y.w/2,C=o.yCoords[m]-y.h/2,E=o.yCoords[m]+y.h/2;x<r&&(r=x);b>s&&(s=b);C<a&&(a=C);E>d&&(d=E)}}}catch(e){l=!0;u=e}finally{try{if(!c&&p.return){p.return()}}finally{if(l){throw u}}}var I=t.x-(s+r)/2,A=t.y-(d+a)/2;o.xCoords=o.xCoords.map(function(e){return e+I});o.yCoords=o.yCoords.map(function(e){return e+A})}else{Object.keys(o).forEach(function(e){var t=o[e];var n=t.getRect().x;var i=t.getRect().x+t.getRect().width;var c=t.getRect().y;var l=t.getRect().y+t.getRect().height;n<r&&(r=n);i>s&&(s=i);c<a&&(a=c);l>d&&(d=l)});var N=t.x-(s+r)/2,D=t.y-(d+a)/2;Object.keys(o).forEach(function(e){var t=o[e];t.setCenter(t.getCenterX()+N,t.getCenterY()+D)})}}};s.calcBoundingBox=function(e,t,o,n){var i=Number.MAX_SAFE_INTEGER;var r=Number.MIN_SAFE_INTEGER;var s=Number.MAX_SAFE_INTEGER;var a=Number.MIN_SAFE_INTEGER;var d=void 0;var c=void 0;var l=void 0;var u=void 0;var p=e.descendants().not(":parent");var h=p.length;for(var _=0;_<h;_++){var g=p[_];d=t[n.get(g.id())]-g.width()/2;c=t[n.get(g.id())]+g.width()/2;l=o[n.get(g.id())]-g.height()/2;u=o[n.get(g.id())]+g.height()/2;i>d&&(i=d);r<c&&(r=c);s>l&&(s=l);a<u&&(a=u)}var f={};f.topLeftX=i;f.topLeftY=s;f.width=r-i;f.height=a-s;return f};s.calcParentsWithoutChildren=function(e,t){var o=e.collection();t.nodes(":parent").forEach(function(e){var t=!1;e.children().forEach(function(e){e.css("display")!="none"&&(t=!0)});t||o.merge(e)});return o};t.exports=s},816:(e,t,o)=>{var n=o(548);var i=o(140).CoSELayout;var r=o(140).CoSENode;var s=o(140).layoutBase.PointD;var a=o(140).layoutBase.DimensionD;var d=o(140).layoutBase.LayoutConstants;var c=o(140).layoutBase.FDLayoutConstants;var l=o(140).CoSEConstants;var u=function e(t,o){var u=t.cy;var p=t.eles;var h=p.nodes();var _=p.edges();var g=void 0;var f=void 0;var m=void 0;var v={};if(t.randomize){g=o["nodeIndexes"];f=o["xCoords"];m=o["yCoords"]}var y=function e(t){return typeof t==="function"};var x=function e(t,o){if(y(t)){return t(o)}else{return t}};var b=n.calcParentsWithoutChildren(u,p);var C=function e(t,o,i,d){var c=o.length;for(var l=0;l<c;l++){var u=o[l],p=null;u.intersection(b).length==0&&(p=u.children());var h=void 0,_=u.layoutDimensions({nodeDimensionsIncludeLabels:d.nodeDimensionsIncludeLabels});if(u.outerWidth()!=null&&u.outerHeight()!=null){if(d.randomize){if(!u.isParent()){h=t.add(new r(i.graphManager,new s(f[g.get(u.id())]-_.w/2,m[g.get(u.id())]-_.h/2),new a(parseFloat(_.w),parseFloat(_.h))))}else{var y=n.calcBoundingBox(u,f,m,g);if(u.intersection(b).length==0){h=t.add(new r(i.graphManager,new s(y.topLeftX,y.topLeftY),new a(y.width,y.height)))}else{h=t.add(new r(i.graphManager,new s(y.topLeftX,y.topLeftY),new a(parseFloat(_.w),parseFloat(_.h))))}}}else{h=t.add(new r(i.graphManager,new s(u.position("x")-_.w/2,u.position("y")-_.h/2),new a(parseFloat(_.w),parseFloat(_.h))))}}else{h=t.add(new r(this.graphManager))}h.id=u.data("id");h.nodeRepulsion=x(d.nodeRepulsion,u);h.paddingLeft=parseInt(u.css("padding"));h.paddingTop=parseInt(u.css("padding"));h.paddingRight=parseInt(u.css("padding"));h.paddingBottom=parseInt(u.css("padding"));if(d.nodeDimensionsIncludeLabels){h.labelWidth=u.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).w;h.labelHeight=u.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).h;h.labelPosVertical=u.css("text-valign");h.labelPosHorizontal=u.css("text-halign")}v[u.data("id")]=h;isNaN(h.rect.x)&&(h.rect.x=0);isNaN(h.rect.y)&&(h.rect.y=0);if(p!=null&&p.length>0){var C=void 0;C=i.getGraphManager().add(i.newGraph(),h);e(C,p,i,d)}}};var E=function e(o,n,i){var r=0;var s=0;for(var a=0;a<i.length;a++){var d=i[a],u=v[d.data("source")],p=v[d.data("target")];if(u&&p&&u!==p&&u.getEdgesBetween(p).length==0){var h=n.add(o.newEdge(),u,p);h.id=d.id();h.idealLength=x(t.idealEdgeLength,d);h.edgeElasticity=x(t.edgeElasticity,d);r+=h.idealLength;s++}}if(t.idealEdgeLength!=null){if(s>0)l.DEFAULT_EDGE_LENGTH=c.DEFAULT_EDGE_LENGTH=r/s;else if(!y(t.idealEdgeLength))l.DEFAULT_EDGE_LENGTH=c.DEFAULT_EDGE_LENGTH=t.idealEdgeLength;else l.DEFAULT_EDGE_LENGTH=c.DEFAULT_EDGE_LENGTH=50;l.MIN_REPULSION_DIST=c.MIN_REPULSION_DIST=c.DEFAULT_EDGE_LENGTH/10;l.DEFAULT_RADIAL_SEPARATION=c.DEFAULT_EDGE_LENGTH}};var I=function e(t,o){o.fixedNodeConstraint&&(t.constraints["fixedNodeConstraint"]=o.fixedNodeConstraint);o.alignmentConstraint&&(t.constraints["alignmentConstraint"]=o.alignmentConstraint);o.relativePlacementConstraint&&(t.constraints["relativePlacementConstraint"]=o.relativePlacementConstraint)};t.nestingFactor!=null&&(l.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=c.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=t.nestingFactor);t.gravity!=null&&(l.DEFAULT_GRAVITY_STRENGTH=c.DEFAULT_GRAVITY_STRENGTH=t.gravity);t.numIter!=null&&(l.MAX_ITERATIONS=c.MAX_ITERATIONS=t.numIter);t.gravityRange!=null&&(l.DEFAULT_GRAVITY_RANGE_FACTOR=c.DEFAULT_GRAVITY_RANGE_FACTOR=t.gravityRange);t.gravityCompound!=null&&(l.DEFAULT_COMPOUND_GRAVITY_STRENGTH=c.DEFAULT_COMPOUND_GRAVITY_STRENGTH=t.gravityCompound);t.gravityRangeCompound!=null&&(l.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=c.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=t.gravityRangeCompound);t.initialEnergyOnIncremental!=null&&(l.DEFAULT_COOLING_FACTOR_INCREMENTAL=c.DEFAULT_COOLING_FACTOR_INCREMENTAL=t.initialEnergyOnIncremental);t.tilingCompareBy!=null&&(l.TILING_COMPARE_BY=t.tilingCompareBy);if(t.quality=="proof")d.QUALITY=2;else d.QUALITY=0;l.NODE_DIMENSIONS_INCLUDE_LABELS=c.NODE_DIMENSIONS_INCLUDE_LABELS=d.NODE_DIMENSIONS_INCLUDE_LABELS=t.nodeDimensionsIncludeLabels;l.DEFAULT_INCREMENTAL=c.DEFAULT_INCREMENTAL=d.DEFAULT_INCREMENTAL=!t.randomize;l.ANIMATE=c.ANIMATE=d.ANIMATE=t.animate;l.TILE=t.tile;l.TILING_PADDING_VERTICAL=typeof t.tilingPaddingVertical==="function"?t.tilingPaddingVertical.call():t.tilingPaddingVertical;l.TILING_PADDING_HORIZONTAL=typeof t.tilingPaddingHorizontal==="function"?t.tilingPaddingHorizontal.call():t.tilingPaddingHorizontal;l.DEFAULT_INCREMENTAL=c.DEFAULT_INCREMENTAL=d.DEFAULT_INCREMENTAL=!0;l.PURE_INCREMENTAL=!t.randomize;d.DEFAULT_UNIFORM_LEAF_NODE_SIZES=t.uniformNodeDimensions;if(t.step=="transformed"){l.TRANSFORM_ON_CONSTRAINT_HANDLING=!0;l.ENFORCE_CONSTRAINTS=!1;l.APPLY_LAYOUT=!1}if(t.step=="enforced"){l.TRANSFORM_ON_CONSTRAINT_HANDLING=!1;l.ENFORCE_CONSTRAINTS=!0;l.APPLY_LAYOUT=!1}if(t.step=="cose"){l.TRANSFORM_ON_CONSTRAINT_HANDLING=!1;l.ENFORCE_CONSTRAINTS=!1;l.APPLY_LAYOUT=!0}if(t.step=="all"){if(t.randomize)l.TRANSFORM_ON_CONSTRAINT_HANDLING=!0;else l.TRANSFORM_ON_CONSTRAINT_HANDLING=!1;l.ENFORCE_CONSTRAINTS=!0;l.APPLY_LAYOUT=!0}if(t.fixedNodeConstraint||t.alignmentConstraint||t.relativePlacementConstraint){l.TREE_REDUCTION_ON_INCREMENTAL=!1}else{l.TREE_REDUCTION_ON_INCREMENTAL=!0}var e=new i;var A=e.newGraphManager();C(A.addRoot(),n.getTopMostNodes(h),e,t);E(e,A,_);I(e,t);e.runLayout();return v};e.exports={coseLayout:u}},212:(t,o,n)=>{var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1;n.configurable=!0;"value"in n&&(n.writable=!0);Object.defineProperty(e,n.key,n)}}return function(t,o,n){o&&e(t.prototype,o);n&&e(t,n);return t}}();function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=n(658);var a=n(548);var d=n(657),c=d.spectralLayout;var l=n(816),u=l.coseLayout;var p=Object.freeze({quality:"default",randomize:!0,animate:!0,animationDuration:1e3,animationEasing:e,fit:!0,padding:30,nodeDimensionsIncludeLabels:!1,uniformNodeDimensions:!1,packComponents:!0,step:"all",samplingType:!0,sampleSize:25,nodeSeparation:75,piTol:1E-07,nodeRepulsion:function e(t){return 4500},idealEdgeLength:function e(t){return 50},edgeElasticity:function e(t){return.45},nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,tilingCompareBy:e,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3,fixedNodeConstraint:e,alignmentConstraint:e,relativePlacementConstraint:e,ready:function e(){},stop:function e(){}});var h=function(){function t(e){r(this,t);this.options=s({},p,e)}i(t,[{key:"run",value:function t(){var o=this;var n=this.options;var i=n.cy;var r=n.eles;var s=[];var d=[];var l=void 0;var p=[];n.fixedNodeConstraint&&(!Array.isArray(n.fixedNodeConstraint)||n.fixedNodeConstraint.length==0)&&(n.fixedNodeConstraint=e);if(n.alignmentConstraint){n.alignmentConstraint.vertical&&(!Array.isArray(n.alignmentConstraint.vertical)||n.alignmentConstraint.vertical.length==0)&&(n.alignmentConstraint.vertical=e);n.alignmentConstraint.horizontal&&(!Array.isArray(n.alignmentConstraint.horizontal)||n.alignmentConstraint.horizontal.length==0)&&(n.alignmentConstraint.horizontal=e)}n.relativePlacementConstraint&&(!Array.isArray(n.relativePlacementConstraint)||n.relativePlacementConstraint.length==0)&&(n.relativePlacementConstraint=e);var h=n.fixedNodeConstraint||n.alignmentConstraint||n.relativePlacementConstraint;if(h){n.tile=!1;n.packComponents=!1}var _=void 0;var g=!1;if(i.layoutUtilities&&n.packComponents){_=i.layoutUtilities("get");_||(_=i.layoutUtilities());g=!0}if(r.nodes().length>0){if(!g){var f=n.eles.boundingBox();p.push({x:f.x1+f.w/2,y:f.y1+f.h/2});if(n.randomize){var m=c(n);s.push(m)}if(n.quality=="default"||n.quality=="proof"){d.push(u(n,s[0]));a.relocateComponent(p[0],d[0],n)}else{a.relocateComponent(p[0],s[0],n)}}else{var v=a.getTopMostNodes(n.eles.nodes());l=a.connectComponents(i,n.eles,v);l.forEach(function(e){var t=e.boundingBox();p.push({x:t.x1+t.w/2,y:t.y1+t.h/2})});n.randomize&&l.forEach(function(e){n.eles=e;s.push(c(n))});if(n.quality=="default"||n.quality=="proof"){var y=i.collection();if(n.tile){var x=new Map,b=[],C=[],E=0,I={nodeIndexes:x,xCoords:b,yCoords:C},A=[];l.forEach(function(e,t){if(e.edges().length==0){e.nodes().forEach(function(t,o){y.merge(e.nodes()[o]);if(!t.isParent()){I.nodeIndexes.set(e.nodes()[o].id(),E++);I.xCoords.push(e.nodes()[0].position().x);I.yCoords.push(e.nodes()[0].position().y)}});A.push(t)}});if(y.length>1){var N=y.boundingBox();p.push({x:N.x1+N.w/2,y:N.y1+N.h/2});l.push(y);s.push(I);for(var D=A.length-1;D>=0;D--){l.splice(A[D],1);s.splice(A[D],1);p.splice(A[D],1)}}}l.forEach(function(e,t){n.eles=e;d.push(u(n,s[t]));a.relocateComponent(p[t],d[t],n)})}else{l.forEach(function(e,t){a.relocateComponent(p[t],s[t],n)})}var w=new Set;if(l.length>1){var k=[],S=r.filter(function(e){return e.css("display")=="none"});l.forEach(function(e,t){var o=void 0;n.quality=="draft"&&(o=s[t].nodeIndexes);if(e.nodes().not(S).length>0){var i={};i.edges=[];i.nodes=[];var r=void 0;e.nodes().not(S).forEach(function(e){if(n.quality=="draft"){if(!e.isParent()){r=o.get(e.id());i.nodes.push({x:s[t].xCoords[r]-e.boundingbox().w/2,y:s[t].yCoords[r]-e.boundingbox().h/2,width:e.boundingbox().w,height:e.boundingbox().h})}else{var c=a.calcBoundingBox(e,s[t].xCoords,s[t].yCoords,o);i.nodes.push({x:c.topLeftX,y:c.topLeftY,width:c.width,height:c.height})}}else{d[t][e.id()]&&i.nodes.push({x:d[t][e.id()].getLeft(),y:d[t][e.id()].getTop(),width:d[t][e.id()].getWidth(),height:d[t][e.id()].getHeight()})}});e.edges().forEach(function(e){var r=e.source();var c=e.target();if(r.css("display")!="none"&&c.css("display")!="none"){if(n.quality=="draft"){var l=o.get(r.id()),u=o.get(c.id()),p=[],h=[];if(r.isParent()){var _=a.calcBoundingBox(r,s[t].xCoords,s[t].yCoords,o);p.push(_.topLeftX+_.width/2);p.push(_.topLeftY+_.height/2)}else{p.push(s[t].xCoords[l]);p.push(s[t].yCoords[l])}if(c.isParent()){var g=a.calcBoundingBox(c,s[t].xCoords,s[t].yCoords,o);h.push(g.topLeftX+g.width/2);h.push(g.topLeftY+g.height/2)}else{h.push(s[t].xCoords[u]);h.push(s[t].yCoords[u])}i.edges.push({startX:p[0],startY:p[1],endX:h[0],endY:h[1]})}else{d[t][r.id()]&&d[t][c.id()]&&i.edges.push({startX:d[t][r.id()].getCenterX(),startY:d[t][r.id()].getCenterY(),endX:d[t][c.id()].getCenterX(),endY:d[t][c.id()].getCenterY()})}}});if(i.nodes.length>0){k.push(i);w.add(t)}}});var R=_.packComponents(k,n.randomize).shifts;if(n.quality=="draft"){s.forEach(function(e,t){var o=e.xCoords.map(function(e){return e+R[t].dx});var n=e.yCoords.map(function(e){return e+R[t].dy});e.xCoords=o;e.yCoords=n})}else{var T=0;w.forEach(function(e){Object.keys(d[e]).forEach(function(t){var o=d[e][t];o.setCenter(o.getCenterX()+R[T].dx,o.getCenterY()+R[T].dy)});T++})}}}}var L=function t(o,i){if(n.quality=="default"||n.quality=="proof"){typeof o==="number"&&(o=i);var r=void 0,a=void 0,c=o.data("id");d.forEach(function(e){if(c in e){r={x:e[c].getRect().getCenterX(),y:e[c].getRect().getCenterY()};a=e[c]}});if(n.nodeDimensionsIncludeLabels){if(a.labelWidth){if(a.labelPosHorizontal=="left"){r.x+=a.labelWidth/2}else a.labelPosHorizontal=="right"&&(r.x-=a.labelWidth/2)}if(a.labelHeight){if(a.labelPosVertical=="top"){r.y+=a.labelHeight/2}else a.labelPosVertical=="bottom"&&(r.y-=a.labelHeight/2)}}r==e&&(r={x:o.position("x"),y:o.position("y")});return{x:r.x,y:r.y}}else{var l=void 0;s.forEach(function(t){var n=t.nodeIndexes.get(o.id());n!=e&&(l={x:t.xCoords[n],y:t.yCoords[n]})});l==e&&(l={x:o.position("x"),y:o.position("y")});return{x:l.x,y:l.y}}};if(n.quality=="default"||n.quality=="proof"||n.randomize){var B=a.calcParentsWithoutChildren(i,r),Y=r.filter(function(e){return e.css("display")=="none"});n.eles=r.not(Y);r.nodes().not(":parent").not(Y).layoutPositions(o,n,L);B.length>0&&B.forEach(function(e){e.position(L(e))})}else{console.log("If randomize option is set to false, then quality option must be 'default' or 'proof'.")}}}]);return t}();t.exports=h},657:(t,o,n)=>{var i=n(548);var r=n(140).layoutBase.Matrix;var s=n(140).layoutBase.SVD;var a=function t(o){var n=o.cy;var a=o.eles;var d=a.nodes();var c=a.nodes(":parent");var l=new Map;var u=new Map;var p=new Map;var h=[];var _=[];var g=[];var f=[];var m=[];var v=[];var y=[];var x=[];var b=void 0;var C=1e8;var E=1E-09;var I=o.piTol;var A=o.samplingType;var N=o.nodeSeparation;var D=void 0;var w=function e(){var t=0;var o=0;var n=!1;while(o<D){t=Math.floor(Math.random()*b);n=!1;for(var i=0;i<o;i++){if(f[i]==t){n=!0;break}}if(!n){f[o]=t;o++}else{continue}}};var k=function e(t,o,n){var i=[];var r=0;var s=0;var a=0;var d=void 0;var c=[];var l=0;var p=1;for(var _=0;_<b;_++){c[_]=C}i[s]=t;c[t]=0;while(s>=r){a=i[r++];var g=h[a];for(var f=0;f<g.length;f++){d=u.get(g[f]);if(c[d]==C){c[d]=c[a]+1;i[++s]=d}}v[a][o]=c[a]*N}if(n){for(var y=0;y<b;y++){v[y][o]<m[y]&&(m[y]=v[y][o])}for(var x=0;x<b;x++){if(m[x]>l){l=m[x];p=x}}}return p};var S=function e(t){var o=void 0;if(!t){w();for(var n=0;n<D;n++){k(f[n],n,t,!1)}}else{o=Math.floor(Math.random()*b);for(var i=0;i<b;i++){m[i]=C}for(var r=0;r<D;r++){f[r]=o;o=k(o,r,t)}}for(var s=0;s<b;s++){for(var a=0;a<D;a++){v[s][a]*=v[s][a]}}for(var d=0;d<D;d++){y[d]=[]}for(var c=0;c<D;c++){for(var l=0;l<D;l++){y[c][l]=v[f[l]][c]}}};var R=function e(){var t=s.svd(y);var o=t.S;var n=t.U;var i=t.V;var a=o[0]*o[0]*o[0];var d=[];for(var c=0;c<D;c++){d[c]=[];for(var l=0;l<D;l++){d[c][l]=0;c==l&&(d[c][l]=o[c]/(o[c]*o[c]+a/(o[c]*o[c])))}}x=r.multMat(r.multMat(i,d),r.transpose(n))};var T=function e(){var t=void 0;var o=void 0;var n=[];var i=[];var s=[];var a=[];for(var d=0;d<b;d++){n[d]=Math.random();i[d]=Math.random()}n=r.normalize(n);i=r.normalize(i);var c=0;var l=E;var u=E;var p=void 0;while(!0){c++;for(var h=0;h<b;h++){s[h]=n[h]}n=r.multGamma(r.multL(r.multGamma(s),v,x));t=r.dotProduct(s,n);n=r.normalize(n);l=r.dotProduct(s,n);p=Math.abs(l/u);if(p<=1+I&&p>=1){break}u=l}for(var f=0;f<b;f++){s[f]=n[f]}c=0;u=E;while(!0){c++;for(var m=0;m<b;m++){a[m]=i[m]}a=r.minusOp(a,r.multCons(s,r.dotProduct(s,a)));i=r.multGamma(r.multL(r.multGamma(a),v,x));o=r.dotProduct(a,i);i=r.normalize(i);l=r.dotProduct(a,i);p=Math.abs(l/u);if(p<=1+I&&p>=1){break}u=l}for(var y=0;y<b;y++){a[y]=i[y]}_=r.multCons(s,Math.sqrt(Math.abs(t)));g=r.multCons(a,Math.sqrt(Math.abs(o)))};i.connectComponents(n,a,i.getTopMostNodes(d),l);c.forEach(function(e){i.connectComponents(n,a,i.getTopMostNodes(e.descendants().intersection(a)),l)});var L=0;for(var B=0;B<d.length;B++){d[B].isParent()||u.set(d[B].id(),L++)}var Y=!0;var G=!1;var F=e;try{for(var M=l.keys()[Symbol.iterator](),z;!(Y=(z=M.next()).done);Y=!0){var X=z.value;u.set(X,L++)}}catch(e){G=!0;F=e}finally{try{if(!Y&&M.return){M.return()}}finally{if(G){throw F}}}for(var P=0;P<u.size;P++){h[P]=[]}c.forEach(function(e){var t=e.children().intersection(a);while(t.nodes(":childless").length==0){t=t.nodes()[0].children().intersection(a)}var o=0;var n=t.nodes(":childless")[0].connectedEdges().length;t.nodes(":childless").forEach(function(e,t){if(e.connectedEdges().length<n){n=e.connectedEdges().length;o=t}});p.set(e.id(),t.nodes(":childless")[o].id())});d.forEach(function(e){var t=void 0;if(e.isParent())t=u.get(p.get(e.id()));else t=u.get(e.id());e.neighborhood().nodes().forEach(function(o){if(a.intersection(e.edgesWith(o)).length>0){if(o.isParent())h[t].push(p.get(o.id()));else h[t].push(o.id())}})});var O=function e(t){var o=u.get(t);var i=void 0;l.get(t).forEach(function(e){if(n.getElementById(e).isParent())i=p.get(e);else i=e;h[o].push(i);h[u.get(i)].push(t)})};var J=!0;var j=!1;var H=e;try{for(var $=l.keys()[Symbol.iterator](),q;!(J=(q=$.next()).done);J=!0){var V=q.value;O(V)}}catch(e){j=!0;H=e}finally{try{if(!J&&$.return){$.return()}}finally{if(j){throw H}}}b=u.size;var U=void 0;if(b>2){D=b<o.sampleSize?b:o.sampleSize;for(var Z=0;Z<b;Z++){v[Z]=[]}for(var W=0;W<D;W++){x[W]=[]}if(o.quality=="draft"||o.step=="all"){S(A);R();T();U={nodeIndexes:u,xCoords:_,yCoords:g}}else{u.forEach(function(e,t){_.push(n.getElementById(t).position("x"));g.push(n.getElementById(t).position("y"))});U={nodeIndexes:u,xCoords:_,yCoords:g}}return U}else{var K=u.keys(),Q=n.getElementById(K.next().value),ee=Q.position(),te=Q.outerWidth();_.push(ee.x);g.push(ee.y);if(b==2){var oe=n.getElementById(K.next().value),ne=oe.outerWidth();_.push(ee.x+te/2+ne/2+o.idealEdgeLength);g.push(ee.y)}U={nodeIndexes:u,xCoords:_,yCoords:g};return U}};t.exports={spectralLayout:a}},579:(e,t,o)=>{var n=o(212);var i=function e(t){if(!t){return}t("layout","fcose",n)};typeof cytoscape!=="undefined"&&i(cytoscape);e.exports=i},140:e=>{e.exports=t}};var n={};function i(t){var r=n[t];if(r!==e){return r.exports}var s=n[t]={exports:{}};o[t](s,s.exports,i);return s.exports}var r=i(579);return r})()});return t(i.exports)}.call(window);var k;var S={L:"left",R:"right",T:"top",B:"bottom"};var R={L:i(e=>`${e},${e/2} 0,${e} 0,0`,"L"),R:i(e=>`0,${e/2} ${e},0 ${e},${e}`,"R"),T:i(e=>`0,0 ${e},0 ${e/2},${e}`,"T"),B:i(e=>`${e/2},0 ${e},${e} 0,${e}`,"B")};var T={L:i((e,t)=>e-t+2,"L"),R:i((e,t)=>e-2,"R"),T:i((e,t)=>e-t+2,"T"),B:i((e,t)=>e-2,"B")};var L=i(function(e){if(Y(e)){return e==="L"?"R":"L"}else{return e==="T"?"B":"T"}},"getOppositeArchitectureDirection");var B=i(function(e){return e==="L"||e==="R"||e==="T"||e==="B"},"isArchitectureDirection");var Y=i(function(e){return e==="L"||e==="R"},"isArchitectureDirectionX");var G=i(function(e){return e==="T"||e==="B"},"isArchitectureDirectionY");var F=i(function(e,t){const o=Y(e)&&G(t);const n=G(e)&&Y(t);return o||n},"isArchitectureDirectionXY");var M=i(function(e){const t=e[0];const o=e[1];const n=Y(t)&&G(o);const i=G(t)&&Y(o);return n||i},"isArchitecturePairXY");var z=i(function(e){return e!=="LL"&&e!=="RR"&&e!=="TT"&&e!=="BB"},"isValidArchitectureDirectionPair");var X=i(function(e,t){const o=`${e}${t}`;return z(o)?o:void 0},"getArchitectureDirectionPair");var P=i(function([e,t],o){const n=o[0];const i=o[1];if(Y(n)){if(G(i)){return[e+(n==="L"?-1:1),t+(i==="T"?1:-1)]}else{return[e+(n==="L"?-1:1),t]}}else{if(Y(i)){return[e+(i==="L"?1:-1),t+(n==="T"?1:-1)]}else{return[e,t+(n==="T"?1:-1)]}}},"shiftPositionByArchitectureDirectionPair");var O=i(function(e){if(e==="LT"||e==="TL"){return[1,1]}else if(e==="BL"||e==="LB"){return[1,-1]}else if(e==="BR"||e==="RB"){return[-1,-1]}else{return[-1,1]}},"getArchitectureDirectionXYFactors");var J=i(function(e,t){if(F(e,t)){return"bend"}else if(Y(e)){return"horizontal"}return"vertical"},"getArchitectureDirectionAlignment");var j=i(function(e){return e.type==="service"},"isArchitectureService");var H=i(function(e){return e.type==="junction"},"isArchitectureJunction");var $=i(e=>e.data(),"edgeData");var q=i(e=>e.data(),"nodeData");var V=h.architecture;var U=(k=class{constructor(){this.nodes={};this.groups={};this.edges=[];this.registeredIds={};this.elements={};this.setAccTitle=r;this.getAccTitle=s;this.setDiagramTitle=a;this.getDiagramTitle=d;this.getAccDescription=c;this.setAccDescription=l;this.clear()}clear(){this.nodes={};this.groups={};this.edges=[];this.registeredIds={};this.dataStructures=void 0;this.elements={};u()}addService({id:e,icon:t,in:o,title:n,iconText:i}){if(this.registeredIds[e]!==void 0){throw new Error(`The service id [${e}] is already in use by another ${this.registeredIds[e]}`)}if(o!==void 0){if(e===o){throw new Error(`The service [${e}] cannot be placed within itself`)}if(this.registeredIds[o]===void 0){throw new Error(`The service [${e}]'s parent does not exist. Please make sure the parent is created before this service`)}if(this.registeredIds[o]==="node"){throw new Error(`The service [${e}]'s parent is not a group`)}}this.registeredIds[e]="node";this.nodes[e]={id:e,type:"service",icon:t,iconText:i,title:n,edges:[],in:o}}getServices(){return Object.values(this.nodes).filter(j)}addJunction({id:e,in:t}){this.registeredIds[e]="node";this.nodes[e]={id:e,type:"junction",edges:[],in:t}}getJunctions(){return Object.values(this.nodes).filter(H)}getNodes(){return Object.values(this.nodes)}getNode(e){var t;return(t=this.nodes[e])!==null&&t!==void 0?t:null}addGroup({id:e,icon:t,in:o,title:n}){var i,r,s;if(((i=this.registeredIds)===null||i===void 0?void 0:i[e])!==void 0){throw new Error(`The group id [${e}] is already in use by another ${this.registeredIds[e]}`)}if(o!==void 0){if(e===o){throw new Error(`The group [${e}] cannot be placed within itself`)}if(((r=this.registeredIds)===null||r===void 0?void 0:r[o])===void 0){throw new Error(`The group [${e}]'s parent does not exist. Please make sure the parent is created before this group`)}if(((s=this.registeredIds)===null||s===void 0?void 0:s[o])==="node"){throw new Error(`The group [${e}]'s parent is not a group`)}}this.registeredIds[e]="group";this.groups[e]={id:e,icon:t,title:n,in:o}}getGroups(){return Object.values(this.groups)}addEdge({lhsId:e,rhsId:t,lhsDir:o,rhsDir:n,lhsInto:i,rhsInto:r,lhsGroup:s,rhsGroup:a,title:d}){if(!B(o)){throw new Error(`Invalid direction given for left hand side of edge ${e}--${t}. Expected (L,R,T,B) got ${String(o)}`)}if(!B(n)){throw new Error(`Invalid direction given for right hand side of edge ${e}--${t}. Expected (L,R,T,B) got ${String(n)}`)}if(this.nodes[e]===void 0&&this.groups[e]===void 0){throw new Error(`The left-hand id [${e}] does not yet exist. Please create the service/group before declaring an edge to it.`)}if(this.nodes[t]===void 0&&this.groups[t]===void 0){throw new Error(`The right-hand id [${t}] does not yet exist. Please create the service/group before declaring an edge to it.`)}const c=this.nodes[e].in;const l=this.nodes[t].in;if(s&&c&&l&&c==l){throw new Error(`The left-hand id [${e}] is modified to traverse the group boundary, but the edge does not pass through two groups.`)}if(a&&c&&l&&c==l){throw new Error(`The right-hand id [${t}] is modified to traverse the group boundary, but the edge does not pass through two groups.`)}const u={lhsId:e,lhsDir:o,lhsInto:i,lhsGroup:s,rhsId:t,rhsDir:n,rhsInto:r,rhsGroup:a,title:d};this.edges.push(u);if(this.nodes[e]&&this.nodes[t]){this.nodes[e].edges.push(this.edges[this.edges.length-1]);this.nodes[t].edges.push(this.edges[this.edges.length-1])}}getEdges(){return this.edges}getDataStructures(){if(this.dataStructures===void 0){const e={};const t=Object.entries(this.nodes).reduce((t,[o,n])=>{t[o]=n.edges.reduce((t,n)=>{var i,r,s,a;const d=(i=this.getNode(n.lhsId))===null||i===void 0?void 0:i.in;const c=(r=this.getNode(n.rhsId))===null||r===void 0?void 0:r.in;if(d&&c&&d!==c){const t=J(n.lhsDir,n.rhsDir);if(t!=="bend"){(s=e[d])!==null&&s!==void 0?s:e[d]={};e[d][c]=t;(a=e[c])!==null&&a!==void 0?a:e[c]={};e[c][d]=t}}if(n.lhsId===o){const e=X(n.lhsDir,n.rhsDir);if(e){t[e]=n.rhsId}}else{const e=X(n.rhsDir,n.lhsDir);if(e){t[e]=n.lhsId}}return t},{});return t},{});const o=Object.keys(t)[0];const n={[o]:1};const r=Object.keys(t).reduce((e,t)=>t===o?e:{...e,[t]:1},{});const s=i(e=>{const o={[e]:[0,0]};const i=[e];while(i.length>0){const e=i.shift();if(e){n[e]=1;delete r[e];const s=t[e];const[a,d]=o[e];Object.entries(s).forEach(([e,t])=>{if(!n[t]){o[t]=P([a,d],e);i.push(t)}})}}return o},"BFS");const a=[s(o)];while(Object.keys(r).length>0){a.push(s(Object.keys(r)[0]))}this.dataStructures={adjList:t,spatialMaps:a,groupAlignments:e}}return this.dataStructures}setElementForId(e,t){this.elements[e]=t}getElementById(e){return this.elements[e]}getConfig(){return p({...V,..._().architecture})}getConfigField(e){return this.getConfig()[e]}},o(k,"ArchitectureDB"),(()=>{i(k,"ArchitectureDB")})(),k);var Z=i((e,t)=>{g(e,t);e.groups.map(e=>t.addGroup(e));e.services.map(e=>t.addService({...e,type:"service"}));e.junctions.map(e=>t.addJunction({...e,type:"junction"}));e.edges.map(e=>t.addEdge(e))},"populateDb");var W={parser:{yy:void 0},parse:i(async e=>{var t;const o=await f("architecture",e);m.debug(o);const n=(t=W.parser)===null||t===void 0?void 0:t.yy;if(!(n instanceof U)){throw new Error("parser.parser?.yy was not a ArchitectureDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.")}Z(o,n)},"parse")};var K=i(e=>`\n  .edge {\n    stroke-width: ${e.archEdgeWidth};\n    stroke: ${e.archEdgeColor};\n    fill: none;\n  }\n\n  .arrow {\n    fill: ${e.archEdgeArrowColor};\n  }\n\n  .node-bkg {\n    fill: none;\n    stroke: ${e.archGroupBorderColor};\n    stroke-width: ${e.archGroupBorderWidth};\n    stroke-dasharray: 8;\n  }\n  .node-icon-text {\n    display: flex; \n    align-items: center;\n  }\n  \n  .node-icon-text > div {\n    color: #fff;\n    margin: 1px;\n    height: fit-content;\n    text-align: center;\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n  }\n`,"getStyles");var Q=i(e=>`<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/>${e}</g>`,"wrapIcon");var ee={prefix:"mermaid-architecture",height:80,width:80,icons:{database:{body:Q('<path id="b" data-name="4" d="m20,57.86c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path id="c" data-name="3" d="m20,45.95c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path id="d" data-name="2" d="m20,34.05c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse id="e" data-name="1" cx="40" cy="22.14" rx="20" ry="7.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="20" y1="57.86" x2="20" y2="22.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="60" y1="57.86" x2="60" y2="22.14" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/>')},server:{body:Q('<rect x="17.5" y="17.5" width="45" height="45" rx="2" ry="2" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="17.5" y1="32.5" x2="62.5" y2="32.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="17.5" y1="47.5" x2="62.5" y2="47.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><g><path d="m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: #fff; stroke-width: 0px;"/><path d="m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10;"/></g><g><path d="m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: #fff; stroke-width: 0px;"/><path d="m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10;"/></g><g><path d="m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: #fff; stroke-width: 0px;"/><path d="m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10;"/></g><g><circle cx="32.5" cy="25" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="27.5" cy="25" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="22.5" cy="25" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/></g><g><circle cx="32.5" cy="40" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="27.5" cy="40" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="22.5" cy="40" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/></g><g><circle cx="32.5" cy="55" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="27.5" cy="55" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/><circle cx="22.5" cy="55" r=".75" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10;"/></g>')
},disk:{body:Q('<rect x="20" y="15" width="40" height="50" rx="1" ry="1" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="24" cy="19.17" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="56" cy="19.17" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="24" cy="60.83" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="56" cy="60.83" rx=".8" ry=".83" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="40" cy="33.75" rx="14" ry="14.58" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><ellipse cx="40" cy="33.75" rx="4" ry="4.17" style="fill: #fff; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="m37.51,42.52l-4.83,13.22c-.26.71-1.1,1.02-1.76.64l-4.18-2.42c-.66-.38-.81-1.26-.33-1.84l9.01-10.8c.88-1.05,2.56-.08,2.09,1.2Z" style="fill: #fff; stroke-width: 0px;"/>')},internet:{body:Q('<circle cx="40" cy="40" r="22.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="40" y1="17.5" x2="40" y2="62.5" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="17.5" y1="40" x2="62.5" y2="40" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="m39.99,17.51c-15.28,11.1-15.28,33.88,0,44.98" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><path d="m40.01,17.51c15.28,11.1,15.28,33.88,0,44.98" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="19.75" y1="30.1" x2="60.25" y2="30.1" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/><line x1="19.75" y1="49.9" x2="60.25" y2="49.9" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/>')},cloud:{body:Q('<path d="m65,47.5c0,2.76-2.24,5-5,5H20c-2.76,0-5-2.24-5-5,0-1.87,1.03-3.51,2.56-4.36-.04-.21-.06-.42-.06-.64,0-2.6,2.48-4.74,5.65-4.97,1.65-4.51,6.34-7.76,11.85-7.76.86,0,1.69.08,2.5.23,2.09-1.57,4.69-2.5,7.5-2.5,6.1,0,11.19,4.38,12.28,10.17,2.14.56,3.72,2.51,3.72,4.83,0,.03,0,.07-.01.1,2.29.46,4.01,2.48,4.01,4.9Z" style="fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;"/>')},unknown:v,blank:{body:Q("")}}};var te=i(async function(e,t,o){const n=o.getConfigField("padding");const i=o.getConfigField("iconSize");const r=i/2;const s=i/6;const a=s/2;await Promise.all(t.edges().map(async t=>{var i,d;const{source:c,sourceDir:l,sourceArrow:u,sourceGroup:p,target:h,targetDir:_,targetArrow:g,targetGroup:f,label:m}=$(t);let{x:v,y:b}=t[0].sourceEndpoint();const{x:C,y:E}=t[0].midpoint();let{x:I,y:A}=t[0].targetEndpoint();const N=n+4;if(p){if(Y(l)){v+=l==="L"?-N:N}else{b+=l==="T"?-N:N+18}}if(f){if(Y(_)){I+=_==="L"?-N:N}else{A+=_==="T"?-N:N+18}}if(!p&&((i=o.getNode(c))===null||i===void 0?void 0:i.type)==="junction"){if(Y(l)){v+=l==="L"?r:-r}else{b+=l==="T"?r:-r}}if(!f&&((d=o.getNode(h))===null||d===void 0?void 0:d.type)==="junction"){if(Y(_)){I+=_==="L"?r:-r}else{A+=_==="T"?r:-r}}if(t[0]._private.rscratch){let t=e.insert("g");t.insert("path").attr("d",`M ${v},${b} L ${C},${E} L${I},${A} `).attr("class","edge");if(u){let e=Y(l)?T[l](v,s):v-a,o=G(l)?T[l](b,s):b-a;t.insert("polygon").attr("points",R[l](s)).attr("transform",`translate(${e},${o})`).attr("class","arrow")}if(g){let e=Y(_)?T[_](I,s):I-a,o=G(_)?T[_](A,s):A-a;t.insert("polygon").attr("points",R[_](s)).attr("transform",`translate(${e},${o})`).attr("class","arrow")}if(m){let e=!F(l,_)?Y(l)?"X":"Y":"XY",o=0;if(e==="X"){o=Math.abs(v-I)}else if(e==="Y"){o=Math.abs(b-A)/1.5}else{o=Math.abs(v-I)/2}let n=t.append("g");await y(n,m,{useHtmlLabels:!1,width:o,classes:"architecture-service-label"},x());n.attr("dy","1em").attr("alignment-baseline","middle").attr("dominant-baseline","middle").attr("text-anchor","middle");if(e==="X"){n.attr("transform","translate("+C+", "+E+")")}else if(e==="Y"){n.attr("transform","translate("+C+", "+E+") rotate(-90)")}else if(e==="XY"){let e=X(l,_);if(e&&M(e)){let t=n.node().getBoundingClientRect(),[o,i]=O(e);n.attr("dominant-baseline","auto").attr("transform",`rotate(${-1*o*i*45})`);let r=n.node().getBoundingClientRect();n.attr("transform",`\n                translate(${C}, ${E-t.height/2})\n                translate(${o*r.width/2}, ${i*r.height/2})\n                rotate(${-1*o*i*45}, 0, ${t.height/2})\n              `)}}}}}))},"drawEdges");var oe=i(async function(e,t,o){const n=o.getConfigField("padding");const i=n*.75;const r=o.getConfigField("fontSize");const s=o.getConfigField("iconSize");const a=s/2;await Promise.all(t.nodes().map(async t=>{const o=q(t);if(o.type==="group"){let{h:n,w:s,x1:d,y1:c}=t.boundingBox();e.append("rect").attr("x",d+a).attr("y",c+a).attr("width",s).attr("height",n).attr("class","node-bkg");let l=e.append("g"),u=d,p=c;if(o.icon){let e=l.append("g");e.html(`<g>${await b(o.icon,{height:i,width:i,fallbackPrefix:ee.prefix})}</g>`);e.attr("transform","translate("+(u+a+1)+", "+(p+a+1)+")");u+=i;p+=r/2-1-2}if(o.label){let e=l.append("g");await y(e,o.label,{useHtmlLabels:!1,width:s,classes:"architecture-service-label"},x());e.attr("dy","1em").attr("alignment-baseline","middle").attr("dominant-baseline","start").attr("text-anchor","start");e.attr("transform","translate("+(u+a+4)+", "+(p+a+2)+")")}}}))},"drawGroups");var ne=i(async function(e,t,o){var n;const i=x();for(const r of o){let o=t.append("g"),s=e.getConfigField("iconSize");if(r.title){let e=o.append("g");await y(e,r.title,{useHtmlLabels:!1,width:s*1.5,classes:"architecture-service-label"},i);e.attr("dy","1em").attr("alignment-baseline","middle").attr("dominant-baseline","middle").attr("text-anchor","middle");e.attr("transform","translate("+s/2+", "+s+")")}let a=o.append("g");if(r.icon){a.html(`<g>${await b(r.icon,{height:s,width:s,fallbackPrefix:ee.prefix})}</g>`)}else if(r.iconText){a.html(`<g>${await b("blank",{height:s,width:s,fallbackPrefix:ee.prefix})}</g>`);let e=a.append("g"),t=e.append("foreignObject").attr("width",s).attr("height",s),o=t.append("div").attr("class","node-icon-text").attr("style",`height: ${s}px;`).append("div").html(C(r.iconText,i)),d=(n=parseInt(window.getComputedStyle(o.node(),null).getPropertyValue("font-size").replace(/\D/g,"")))!==null&&n!==void 0?n:16;o.attr("style",`-webkit-line-clamp: ${Math.floor((s-2)/d)};`)}else{a.append("path").attr("class","node-bkg").attr("id","node-"+r.id).attr("d",`M0 ${s} v${-s} q0,-5 5,-5 h${s} q5,0 5,5 v${s} H0 Z`)}o.attr("class","architecture-service");let{width:d,height:c}=o._groups[0][0].getBBox();r.width=d;r.height=c;e.setElementForId(r.id,o)}return 0},"drawServices");var ie=i(function(e,t,o){o.forEach(o=>{const n=t.append("g");const i=e.getConfigField("iconSize");const r=n.append("g");r.append("rect").attr("id","node-"+o.id).attr("fill-opacity","0").attr("width",i).attr("height",i);n.attr("class","architecture-junction");const{width:s,height:a}=n._groups[0][0].getBBox();n.width=s;n.height=a;e.setElementForId(o.id,n)})},"drawJunctions");E([{name:ee.prefix,icons:ee}]);I.use(w);function re(e,t,o){e.forEach(e=>{t.add({group:"nodes",data:{type:"service",id:e.id,icon:e.icon,label:e.title,parent:e.in,width:o.getConfigField("iconSize"),height:o.getConfigField("iconSize")},classes:"node-service"})})}i(re,"addServices");function se(e,t,o){e.forEach(e=>{t.add({group:"nodes",data:{type:"junction",id:e.id,parent:e.in,width:o.getConfigField("iconSize"),height:o.getConfigField("iconSize")},classes:"node-junction"})})}i(se,"addJunctions");function ae(e,t){t.nodes().map(t=>{const o=q(t);if(o.type==="group"){return}o.x=t.position().x;o.y=t.position().y;const n=e.getElementById(o.id);n.attr("transform","translate("+(o.x||0)+","+(o.y||0)+")")})}i(ae,"positionNodes");function de(e,t){e.forEach(e=>{t.add({group:"nodes",data:{type:"group",id:e.id,icon:e.icon,label:e.title,parent:e.in},classes:"node-group"})})}i(de,"addGroups");function ce(e,t){e.forEach(e=>{const{lhsId:o,rhsId:n,lhsInto:i,lhsGroup:r,rhsInto:s,lhsDir:a,rhsDir:d,rhsGroup:c,title:l}=e;const u=F(e.lhsDir,e.rhsDir)?"segments":"straight";const p={id:`${o}-${n}`,label:l,source:o,sourceDir:a,sourceArrow:i,sourceGroup:r,sourceEndpoint:a==="L"?"0 50%":a==="R"?"100% 50%":a==="T"?"50% 0":"50% 100%",target:n,targetDir:d,targetArrow:s,targetGroup:c,targetEndpoint:d==="L"?"0 50%":d==="R"?"100% 50%":d==="T"?"50% 0":"50% 100%"};t.add({group:"edges",data:p,classes:u})})}i(ce,"addEdges");function le(e,t,o){const n=i((e,t)=>Object.entries(e).reduce((e,[n,i])=>{var r,s,a;let d=0;const c=Object.entries(i);if(c.length===1){e[n]=c[0][1];return e}for(let i=0;i<c.length-1;i++){for(let l=i+1;l<c.length;l++){let[u,p]=c[i],[h,_]=c[l],g=(r=o[u])===null||r===void 0?void 0:r[h];if(g===t){(s=e[n])!==null&&s!==void 0?s:e[n]=[];e[n]=[...e[n],...p,..._]}else if(u==="default"||h==="default"){(a=e[n])!==null&&a!==void 0?a:e[n]=[];e[n]=[...e[n],...p,..._]}else{let t=`${n}-${d++}`;e[t]=p;let o=`${n}-${d++}`;e[o]=_}}}return e},{}),"flattenAlignments");const r=t.map(t=>{const o={};const i={};Object.entries(t).forEach(([t,[n,r]])=>{var s,a,d,c,l,u;var p,h;const _=(a=(s=e.getNode(t))===null||s===void 0?void 0:s.in)!==null&&a!==void 0?a:"default";(d=o[r])!==null&&d!==void 0?d:o[r]={};(c=(p=o[r])[_])!==null&&c!==void 0?c:p[_]=[];o[r][_].push(t);(l=i[n])!==null&&l!==void 0?l:i[n]={};(u=(h=i[n])[_])!==null&&u!==void 0?u:h[_]=[];i[n][_].push(t)});return{horiz:Object.values(n(o,"horizontal")).filter(e=>e.length>1),vert:Object.values(n(i,"vertical")).filter(e=>e.length>1)}});const[s,a]=r.reduce(([e,t],{horiz:o,vert:n})=>[[...e,...o],[...t,...n]],[[],[]]);return{horizontal:s,vertical:a}}i(le,"getAlignments");function ue(e,t){const o=[];const n=i(e=>`${e[0]},${e[1]}`,"posToStr");const r=i(e=>e.split(",").map(e=>parseInt(e)),"strToPos");e.forEach(e=>{const i=Object.fromEntries(Object.entries(e).map(([e,t])=>[n(t),e]));const s=[n([0,0])];const a={};const d={L:[-1,0],R:[1,0],T:[0,1],B:[0,-1]};while(s.length>0){let e=s.shift();if(e){a[e]=1;let c=i[e];if(c){let l=r(e);Object.entries(d).forEach(([e,r])=>{const d=n([l[0]+r[0],l[1]+r[1]]);const u=i[d];if(u&&!a[d]){s.push(d);o.push({[S[e]]:u,[S[L(e)]]:c,gap:1.5*t.getConfigField("iconSize")})}})}}}});return o}i(ue,"getRelativeConstraints");function pe(e,t,o,n,r,{spatialMaps:s,groupAlignments:a}){return new Promise(d=>{const c=A("body").append("div").attr("id","cy").attr("style","display:none");const l=I({container:document.getElementById("cy"),style:[{selector:"edge",style:{"curve-style":"straight",label:"data(label)","source-endpoint":"data(sourceEndpoint)","target-endpoint":"data(targetEndpoint)"}},{selector:"edge.segments",style:{"curve-style":"segments","segment-weights":"0","segment-distances":[.5],"edge-distances":"endpoints","source-endpoint":"data(sourceEndpoint)","target-endpoint":"data(targetEndpoint)"}},{selector:"node",style:{"compound-sizing-wrt-labels":"include"}},{selector:"node[label]",style:{"text-valign":"bottom","text-halign":"center","font-size":`${r.getConfigField("fontSize")}px`}},{selector:".node-service",style:{label:"data(label)",width:"data(width)",height:"data(height)"}},{selector:".node-junction",style:{width:"data(width)",height:"data(height)"}},{selector:".node-group",style:{padding:`${r.getConfigField("padding")}px`}}],layout:{name:"grid",boundingBox:{x1:0,x2:100,y1:0,y2:100}}});c.remove();de(o,l);re(e,l,r);se(t,l,r);ce(n,l);const u=le(r,s,a);const p=ue(s,r);const h=l.layout({name:"fcose",quality:"proof",styleEnabled:!1,animate:!1,nodeDimensionsIncludeLabels:!1,idealEdgeLength(e){const[t,o]=e.connectedNodes();const{parent:n}=q(t);const{parent:i}=q(o);const s=n===i?1.5*r.getConfigField("iconSize"):.5*r.getConfigField("iconSize");return s},edgeElasticity(e){const[t,o]=e.connectedNodes();const{parent:n}=q(t);const{parent:i}=q(o);const r=n===i?.45:.001;return r},alignmentConstraint:u,relativePlacementConstraint:p});h.one("layoutstop",()=>{var e;function t(e,t,o,n){let i,r;const{x:s,y:a}=e;const{x:d,y:c}=t;r=(n-a+(s-o)*(a-c)/(s-d))/Math.sqrt(1+Math.pow((a-c)/(s-d),2));i=Math.sqrt(Math.pow(n-a,2)+Math.pow(o-s,2)-Math.pow(r,2));const l=Math.sqrt(Math.pow(d-s,2)+Math.pow(c-a,2));i=i/l;let u=(d-s)*(n-a)-(c-a)*(o-s);switch(!0){case u>=0:u=1;break;case u<0:u=-1;break}let p=(d-s)*(o-s)+(c-a)*(n-a);switch(!0){case p>=0:p=1;break;case p<0:p=-1;break}r=Math.abs(r)*u;i=i*p;return{distances:r,weights:i}}i(t,"getSegmentWeights");l.startBatch();for(const o of Object.values(l.edges())){if((e=o.data)===null||e===void 0?void 0:e.call(o)){let{x:e,y:n}=o.source().position(),{x:i,y:r}=o.target().position();if(e!==i&&n!==r){let e=o.sourceEndpoint(),n=o.targetEndpoint(),{sourceDir:i}=$(o),[r,s]=G(i)?[e.x,n.y]:[n.x,e.y],{weights:a,distances:d}=t(e,n,r,s);o.style("segment-distances",d);o.style("segment-weights",a)}}}l.endBatch();h.run()});h.run();l.ready(e=>{m.info("Ready",e);d(l)})})}i(pe,"layoutArchitecture");var he=i(async(e,t,o,n)=>{const i=n.db;const r=i.getServices();const s=i.getJunctions();const a=i.getGroups();const d=i.getEdges();const c=i.getDataStructures();const l=N(t);const u=l.append("g");u.attr("class","architecture-edges");const p=l.append("g");p.attr("class","architecture-services");const h=l.append("g");h.attr("class","architecture-groups");await ne(i,p,r);ie(i,p,s);const _=await pe(r,s,a,d,i,c);await te(u,_,i);await oe(h,_,i);ae(i,_);D(void 0,l,i.getConfigField("padding"),i.getConfigField("useMaxWidth"))},"draw");var _e={draw:he};var ge={parser:W,get db(){return new U},renderer:_e,styles:K};var fe={diagram:ge};__bbb.V=fe}).call(this)